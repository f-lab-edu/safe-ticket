groups:
  - name: alert-rules
    interval: 30s  # 30ì´ˆë§ˆë‹¤ í‰ê°€

    rules:
      - alert: InstanceDown
        expr: up == 0
        for: 3m
        labels:
          severity: critical
        annotations:
            summary: "ğŸ”¥ì„œë²„ ë‹¤ìš´"
            description: "ì„œë²„ê°€ 3ë¶„ ì´ìƒ ì‘ë‹µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
            instance: "{{ $labels.instance }}"

      - alert: HighCPUUsage
        expr: process_cpu_usage > 0.8
        for: 3m
        labels:
          severity: critical
        annotations:
          summary: "ğŸ”¥CPU ì‚¬ìš©ëŸ‰ 80% ì´ˆê³¼"
          description: "CPU ì‚¬ìš©ë¥ ì´ 3ë¶„ ì´ìƒ 80%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤."
          instance: "{{ $labels.instance }}"

      - alert: HighMemoryUsage
        expr: (sum(jvm_memory_used_bytes{area="heap"}) / sum(jvm_memory_max_bytes{area="heap"})) > 0.8
        for: 3m
        labels:
          severity: critical
        annotations:
          summary: "ğŸ”¥ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 80% ì´ˆê³¼"
          description: "ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì´ 3ë¶„ ì´ìƒ 80%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤."
          instance: "{{ $labels.instance }}"

      - alert: HighAvailableTicketsRequests
        expr: sum(increase(available_tickets_requests_total[1m])) > 1000
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "âš ï¸ì¡°íšŒ API ìš”ì²­ì´ ë§ìŠµë‹ˆë‹¤."
          description: "api GET /tickets/available/{showtimeId} ìš”ì²­ì´ ë¶„ë‹¹ 1000íšŒ ì´ˆê³¼ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
          instance: "ticket-app"

      - alert: HighReservationRequests
        expr: sum(increase(reservation_requests_total[1m])) > 1000
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "âš ï¸ì˜ˆì•½ API ìš”ì²­ì´ ë§ìŠµë‹ˆë‹¤."
          description: "api PUT /tickets/reservations ìš”ì²­ì´ ë¶„ë‹¹ 1000íšŒ ì´ˆê³¼ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
          instance: "ticket-app"
